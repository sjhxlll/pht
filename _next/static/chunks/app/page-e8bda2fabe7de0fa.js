(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5057:(e,t,r)=>{"use strict";r.d(t,{Label:()=>n});var a=r(5155);r(2115);var l=r(7073),s=r(9434);function n(e){let{className:t,...r}=e;return(0,a.jsx)(l.b,{"data-slot":"label",className:(0,s.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...r})}},6337:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var a=r(5155),l=r(2115),s=r(4624),n=r(2596);let i=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,c=n.$;var o=r(9434);let d=((e,t)=>r=>{var a;if((null==t?void 0:t.variants)==null)return c(e,null==r?void 0:r.class,null==r?void 0:r.className);let{variants:l,defaultVariants:s}=t,n=Object.keys(l).map(e=>{let t=null==r?void 0:r[e],a=null==s?void 0:s[e];if(null===t)return null;let n=i(t)||i(a);return l[e][n]}),o=r&&Object.entries(r).reduce((e,t)=>{let[r,a]=t;return void 0===a||(e[r]=a),e},{});return c(e,n,null==t||null==(a=t.compoundVariants)?void 0:a.reduce((e,t)=>{let{class:r,className:a,...l}=t;return Object.entries(l).every(e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...s,...o}[t]):({...s,...o})[t]===r})?[...e,r,a]:e},[]),null==r?void 0:r.class,null==r?void 0:r.className)})("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function u(e){let{className:t,variant:r,size:l,asChild:n=!1,...i}=e,c=n?s.Slot:"button";return(0,a.jsx)(c,{"data-slot":"button",className:(0,o.cn)(d({variant:r,size:l,className:t})),...i})}function m(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,o.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function h(e){let{className:t,...r}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,o.cn)("px-6",t),...r})}var g=r(5057),x=r(6671);async function p(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",a=document.createElement("canvas"),l=a.getContext("2d");if(!l)throw Error("Could not get canvas context");let s=await Promise.all(e.map(e=>new Promise((t,r)=>{let a=new Image;a.onload=()=>t(a),a.onerror=r,a.src=URL.createObjectURL(e)})));a.width=s[0].width,a.height=s[0].height,l.drawImage(s[0],0,0);for(let e=1;e<s.length;e++)l.globalCompositeOperation="white"===r?"multiply":"lighten",l.drawImage(s[e],0,0);if(l.globalCompositeOperation="source-over",t){let e=l.getImageData(0,0,a.width,a.height),t=e.data;for(let e=0;e<t.length;e+=4)t[e]=255-t[e],t[e+1]=255-t[e+1],t[e+2]=255-t[e+2];l.putImageData(e,0,0)}return a.toDataURL("image/jpeg",.9)}function f(){let[e,t]=(0,l.useState)([]),[r,s]=(0,l.useState)([]),[n,i]=(0,l.useState)(null),[c,o]=(0,l.useState)(!1),[d,f]=(0,l.useState)(!0),[b,v]=(0,l.useState)("white"),y=(0,l.useRef)(null),j=a=>{t(e.filter((e,t)=>t!==a)),s(r.filter((e,t)=>t!==a)),i(null)},w=async()=>{if(!(e.length<1)){o(!0);try{let t=await p(e,d,b);i(t)}catch(e){x.o.error("处理图片时出错",{description:"请确保所有图片格式正确"})}finally{o(!1)}}};return(0,a.jsx)("div",{className:"bg-muted flex min-h-svh flex-col items-center justify-center p-6 md:p-10",children:(0,a.jsxs)("div",{className:"w-full max-w-sm md:max-w-3xl",children:[(0,a.jsx)(m,{className:"overflow-hidden p-0",children:(0,a.jsxs)(h,{className:"grid p-0 grid-cols-1 md:grid-cols-2",children:[(0,a.jsxs)("form",{className:"p-6 md:p-8 flex flex-col justify-between gap-6",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"拼好图 | PINHAOTU.TOP"}),(0,a.jsx)("p",{className:"text-muted-foreground text-balance",children:"拼好图，吃好饭"})]}),(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"底片类型"}),(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg px-4 py-3.5 cursor-pointer ".concat("white"===b?"ring-2 ring-black/80":""),onClick:()=>v("white"),children:[(0,a.jsx)("input",{id:"baseType-white",type:"radio",name:"baseType",value:"white",checked:"white"===b,onChange:()=>v("white"),className:"accent-black mr-1 pointer-events-none"}),(0,a.jsx)(g.Label,{htmlFor:"baseType-white",className:"flex items-center cursor-pointer select-none mb-0",children:"白色底片"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg px-4 py-3.5 cursor-pointer ".concat("black"===b?"ring-2 ring-black/80":""),onClick:()=>v("black"),children:[(0,a.jsx)("input",{id:"baseType-black",type:"radio",name:"baseType",value:"black",checked:"black"===b,onChange:()=>v("black"),className:"accent-black mr-1 pointer-events-none"}),(0,a.jsx)(g.Label,{htmlFor:"baseType-black",className:"flex items-center cursor-pointer select-none mb-0",children:"黑色底片"})]}),(0,a.jsx)(g.Label,{className:"text-muted-foreground",children:"成片效果"}),(0,a.jsxs)("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg px-4 py-3.5",children:[(0,a.jsx)("input",{id:"invert",type:"checkbox",checked:d,onChange:e=>f(e.target.checked),className:"accent-black w-4 h-4"}),(0,a.jsx)(g.Label,{htmlFor:"invert",className:"cursor-pointer ml-2",children:"反转底片"})]}),e.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"relative isolate w-14 h-14 rounded-md border bg-gray-100 flex items-center justify-center",children:[(0,a.jsx)("img",{src:e,alt:"缩略图",className:"object-cover w-full h-full rounded-md"}),(0,a.jsx)("button",{type:"button",onClick:()=>j(t),className:"absolute -top-2 -right-2 bg-white border cursor-pointer border-gray-300 rounded-full w-5 h-5 flex items-center justify-center text-xs text-gray-500 hover:bg-red-100 hover:text-red-600 shadow","aria-label":"删除",children:"\xd7"})]},t))}),(0,a.jsx)("input",{type:"file",ref:y,onChange:e=>{let r=Array.from(e.target.files||[]);if(r.length<1)return void x.o.error("请选择至少一张图片");t(r),s(r.map(e=>URL.createObjectURL(e))),i(null)},accept:"image/*",multiple:!0,className:"hidden"})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 mt-2",children:[(0,a.jsx)(u,{variant:"outline",type:"button",onClick:()=>{var e;return null==(e=y.current)?void 0:e.click()},className:"w-full",children:"选择图片"}),(0,a.jsx)(u,{type:"button",onClick:w,disabled:0===e.length||c,className:"w-full",children:c?"合成中...":"合成"}),n&&(0,a.jsx)(u,{type:"button",onClick:()=>{if(!n)return;let e=document.createElement("a");e.href=n,e.download="processed-image.jpg",document.body.appendChild(e),e.click(),document.body.removeChild(e)},className:"w-full",variant:"secondary",children:"保存图片"})]})]}),(0,a.jsx)("div",{className:"aspect-[3/4] bg-muted relative flex items-center justify-center",children:(0,a.jsx)("div",{className:"aspect-[3/4] w-full bg-gray-100 overflow-hidden flex items-center justify-center",children:n?(0,a.jsx)("img",{src:n,alt:"预览",className:"object-contain w-full h-full"}):(0,a.jsx)("img",{src:"/placeholder.svg",alt:"占位图",className:"object-cover w-full h-full opacity-60"})})})]})}),(0,a.jsx)("div",{className:"text-muted-foreground *:[a]:hover:text-primary text-center text-xs text-balance *:[a]:underline *:[a]:underline-offset-4 mt-4",children:(0,a.jsxs)("span",{className:"text-muted-foreground",children:["\xa9 2025 ",(0,a.jsx)("a",{href:"https://pinhaotu.top",children:"PINHAOTU.TOP"})," All Rights Reserved"]})})]})})}},7676:(e,t,r)=>{Promise.resolve().then(r.bind(r,6337))},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>s});var a=r(2596),l=r(9688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,l.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[949,671,441,684,358],()=>t(7676)),_N_E=e.O()}]);